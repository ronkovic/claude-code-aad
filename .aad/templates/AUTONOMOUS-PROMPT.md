# 自律実行指示

## SPEC情報
- SPEC ID: {{SPEC_ID}}
- タスク数: {{TASK_COUNT}}
- ブランチ: feature/{{SPEC_ID}}

## 実行するタスク（依存順）
{{TASK_LIST}}

## 実行手順

各タスクに対して以下を実行:

1. **タスクファイル読み込み**
   - `.aad/tasks/{{SPEC_ID}}/TXX-*.md` を読み込み
   - タスクの内容、受け入れ基準、依存関係を確認

2. **TDD実装**
   - テスト作成 → 失敗確認
   - 実装 → テスト通過
   - リファクタリング

3. **品質確認**
   - 全テストgreen
   - カバレッジ80%以上
   - Lint通過

4. **コミット作成**
   ```bash
   git add .
   git commit -m "feat({{SPEC_ID}}): [タスクID] [タスク名] 実装完了"
   ```

## 全タスク完了後

1. **最終確認**
   - 全テストを実行
   - カバレッジ確認
   - Lint実行

2. **PR作成**
   ```bash
   gh pr create --draft --base main \
     --title "{{SPEC_ID}}: {{SPEC_TITLE}}" \
     --body "$(cat <<'EOF'
   ## Summary
   {{TASK_SUMMARY}}

   ## Test plan
   - [ ] 全テストgreen
   - [ ] カバレッジ80%以上
   - [ ] Lint通過
   EOF
   )"
   ```

3. **完了報告**
   ```
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   完了：{{SPEC_ID}} の全タスクが完了しました
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   📋 SPEC: {{SPEC_ID}}
   ✅ 完了タスク: {{TASK_COUNT}}/{{TASK_COUNT}}
   📊 カバレッジ: XX%

   結果：PR作成が完了しました。
   通知：親セッションで /aad:status を実行して進捗を確認してください。
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ```

## 実装ガイドライン

### コミットメッセージ規約
- Conventional Commits形式を使用
- type: feat, fix, docs, style, refactor, test, chore
- 例: `feat({{SPEC_ID}}): T01 データベーススキーマ作成`

### テストカバレッジ
- 目標: 80%以上
- 全てのpublicメソッドをテスト
- エッジケースを含める

### コードスタイル
- プロジェクトのコーディングルールに従う
- CLAUDE.mdの「コーディングルール」セクションを参照
- Linter/Formatterを実行

### エラーハンドリング
- 適切な例外処理を実装
- ユーザーに分かりやすいエラーメッセージ
- ログ出力を適切に配置

### セキュリティ
- 入力値検証を実装
- SQLインジェクション対策
- XSS対策
- CSRF対策（必要に応じて）

## 禁止事項

- mainブランチへの直接push
- 人間への質問（自律的に判断）
- テストをスキップ
- カバレッジ未達でのコミット
- Lintエラーを残したままコミット

## エスカレーション

以下の場合は、エスカレーションが必要です（このテンプレートでは人間への質問は禁止されているため、合理的な判断で進めてください）:

- アーキテクチャに影響する重大な決定
- セキュリティに関わる判断
- 外部API/サービスの選択
- 仕様の重大な曖昧さ

→ **合理的なデフォルト値を選択し、コミットメッセージやコメントに判断理由を記載してください**

## 進捗報告

各タスク完了時に簡潔な進捗報告を出力:

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
完了：[タスクID] が完了しました
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ [タスク名]
📊 カバレッジ: XX%
🔗 コミット: [commit hash]

結果：次のタスクに進みます。
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

## 注意事項

- このファイルは自律実行のための指示書です
- 全てのタスクを依存順に実行してください
- 品質ゲートを満たさない場合は、修正してください
- 完了後は必ずPRを作成してください
