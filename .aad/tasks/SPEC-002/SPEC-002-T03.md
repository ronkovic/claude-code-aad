# SPEC-002-T03: AadConfig 構造体実装

## 基本情報

| 項目 | 内容 |
|------|------|
| タスクID | SPEC-002-T03 |
| SPEC | SPEC-002 |
| 複雑度 | M（4-8時間） |
| 優先度 | Must |
| 依存 | T02 |
| 担当 | 未アサイン |

---

## 概要

`config/aad.toml` ファイルを読み込み、`AadConfig` 構造体にデシリアライズする。デフォルト値と適切なエラーハンドリングを提供する。

---

## 作業内容

### 1. AadConfig 構造体定義
```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct AadConfig {
    pub version: String,
    pub context_threshold: u8,  // 0-100
    pub default_branch: Option<String>,
    pub workflow: WorkflowConfig,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct WorkflowConfig {
    pub phases: Vec<Phase>,
    pub auto_transition: bool,
}
```

### 2. 読み込みロジック実装
- `AadConfig::load(path: &Path) -> Result<Self, Error>`
- ファイル存在チェック
- TOML パース
- デシリアライズ

### 3. デフォルト値実装
- `Default` トレイトを実装
- 適切なデフォルト値を設定

### 4. サンプル設定ファイル作成
- `config/aad.toml` を作成

---

## 変更ファイル

| ファイル | 操作 | 説明 |
|----------|------|------|
| `crates/infrastructure/src/config/mod.rs` | 変更 | aad_config モジュールを追加 |
| `crates/infrastructure/src/config/aad_config.rs` | 新規 | AadConfig 実装 |
| `config/aad.toml` | 新規 | サンプル設定ファイル |

---

## 受け入れ基準

- [ ] AC-3.1: `infrastructure/src/config/aad_config.rs` に `AadConfig` 構造体が定義されている
- [ ] AC-3.2: `AadConfig::load(path)` メソッドが実装されている
- [ ] AC-3.3: デフォルト値が `Default` トレイトで提供されている
- [ ] AC-3.4: 必須フィールドの欠落時に適切なエラーを返す
- [ ] AC-3.5: 不正な TOML 構文に対してエラーを返す

---

## テスト項目

| テスト | 内容 | 期待結果 |
|--------|------|----------|
| test_aad_config_load | 正常な設定ファイルの読み込み | 成功 |
| test_aad_config_default | デフォルト値の取得 | 適切な値が設定される |
| test_aad_config_missing_field | 必須フィールド欠落 | エラーを返す |
| test_aad_config_invalid_toml | 不正なTOML構文 | エラーを返す |
| test_aad_config_file_not_found | ファイルが存在しない | エラーを返す |
| test_context_threshold_range | 0-100範囲外の値 | エラーを返す |

---

## テストコマンド

```bash
# テスト実行
cargo test -p infrastructure aad_config

# 全テスト
cargo test --all
```

---

## 備考

- T04（StyleConfig）と並列実行可能
- バリデーションロジックは T06 で強化
