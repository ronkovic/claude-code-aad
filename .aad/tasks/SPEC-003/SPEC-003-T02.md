# SPEC-003-T02: clap コマンド構造定義

## 基本情報

| 項目 | 内容 |
|------|------|
| タスクID | SPEC-003-T02 |
| SPEC | SPEC-003 |
| 複雑度 | S（1-4時間） |
| 優先度 | Must |
| 依存 | T01 |
| 担当 | 未アサイン |

---

## 概要

`clap` を使用してサブコマンド構造を設計し、各コマンドの引数・オプションを定義する。`aad --help` で適切なヘルプメッセージを表示する。

---

## 作業内容

### 1. commands モジュール作成
```rust
// crates/cli/src/commands/mod.rs
use clap::Subcommand;

#[derive(Subcommand)]
pub enum Commands {
    /// プロジェクトを初期化
    Init,

    /// 仕様ファイルを作成
    Spec {
        /// 仕様ID（例: SPEC-001）
        spec_id: String,
    },

    /// タスクを分割
    Tasks {
        /// 仕様ID
        spec_id: String,

        /// GitHub Issues を作成
        #[arg(long)]
        github: bool,
    },

    /// スタイル操作
    Style {
        #[command(subcommand)]
        action: StyleAction,
    },

    /// Git worktree を作成
    Worktree {
        /// 仕様ID
        spec_id: String,
    },
}

#[derive(Subcommand)]
pub enum StyleAction {
    /// スタイル一覧を表示
    List,

    /// スタイルを適用
    Apply {
        /// スタイル名
        style_name: String,
    },
}
```

### 2. main.rs 更新
```rust
mod commands;

use clap::Parser;
use commands::Commands;

#[derive(Parser)]
#[command(name = "aad")]
#[command(version, about = "AI駆動開発ツール", long_about = None)]
struct Cli {
    #[command(subcommand)]
    command: Commands,
}

fn main() -> anyhow::Result<()> {
    let cli = Cli::parse();

    match cli.command {
        Commands::Init => {
            println!("init コマンドが実装されていません");
        }
        Commands::Spec { spec_id } => {
            println!("spec コマンド: {}", spec_id);
        }
        Commands::Tasks { spec_id, github } => {
            println!("tasks コマンド: {} (github: {})", spec_id, github);
        }
        Commands::Style { action } => {
            println!("style コマンドが実装されていません");
        }
        Commands::Worktree { spec_id } => {
            println!("worktree コマンド: {}", spec_id);
        }
    }

    Ok(())
}
```

---

## 変更ファイル

| ファイル | 操作 | 説明 |
|----------|------|------|
| `crates/cli/src/commands/mod.rs` | 新規 | コマンド定義 |
| `crates/cli/src/main.rs` | 変更 | コマンドパース処理 |

---

## 受け入れ基準

- [ ] AC-2.1: `cli/src/commands/` モジュールが存在する
- [ ] AC-2.2: `#[derive(Parser)]` を使用したコマンド構造体が定義されている
- [ ] AC-2.3: `aad --help` が適切なヘルプメッセージを表示する
- [ ] AC-2.4: サブコマンド一覧（init, spec, tasks, style, worktree）が表示される

---

## テストコマンド

```bash
# ヘルプメッセージ確認
cargo run -p cli -- --help
cargo run -p cli -- spec --help
cargo run -p cli -- tasks --help
cargo run -p cli -- style --help
cargo run -p cli -- worktree --help

# 各コマンド動作確認（スタブ）
cargo run -p cli -- init
cargo run -p cli -- spec SPEC-001
cargo run -p cli -- tasks SPEC-001 --github
cargo run -p cli -- style list
cargo run -p cli -- worktree SPEC-001
```

---

## 期待結果

```bash
$ cargo run -p cli -- --help
AI駆動開発ツール

Usage: aad <COMMAND>

Commands:
  init      プロジェクトを初期化
  spec      仕様ファイルを作成
  tasks     タスクを分割
  style     スタイル操作
  worktree  Git worktree を作成
  help      Print this message or the help of the given subcommand(s)

Options:
  -h, --help     Print help
  -V, --version  Print version
```

---

## 備考

- この段階では実装はスタブ（placeholder）
- 実際の処理は T04-T08 で実装
