# SPEC-003-T07: style ã‚³ãƒãƒ³ãƒ‰å®Ÿè£…

## åŸºæœ¬æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ã‚¿ã‚¹ã‚¯ID | SPEC-003-T07 |
| SPEC | SPEC-003 |
| è¤‡é›‘åº¦ | Mï¼ˆ4-8æ™‚é–“ï¼‰ |
| å„ªå…ˆåº¦ | Must |
| ä¾å­˜ | T02, T03 |
| æ‹…å½“ | æœªã‚¢ã‚µã‚¤ãƒ³ |

---

## æ¦‚è¦

`aad style list` ã§ã‚¹ã‚¿ã‚¤ãƒ«ä¸€è¦§ã‚’è¡¨ç¤ºã—ã€`aad style apply <style-name>` ã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ `CLAUDE.md` ã«é©ç”¨ã™ã‚‹ã€‚ãƒˆãƒ¼ã‚¯ãƒ³ç½®æ›ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã€‚

---

## ä½œæ¥­å†…å®¹

### 1. style ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ä½œæˆ
```rust
// crates/cli/src/commands/style.rs
use infrastructure::config::StyleConfig;
use domain::value_objects::StyleName;
use std::fs;
use std::path::Path;

pub fn list() -> anyhow::Result<()> {
    let config = StyleConfig::load(Path::new("config/styles.toml"))?;

    println!("ğŸ“‹ åˆ©ç”¨å¯èƒ½ãªã‚¹ã‚¿ã‚¤ãƒ«:\n");

    for name in config.style_names() {
        println!("  â€¢ {}", name.as_str());
    }

    Ok(())
}

pub fn apply(style_name: &str) -> anyhow::Result<()> {
    let config = StyleConfig::load(Path::new("config/styles.toml"))?;
    let style_name_obj = StyleName::new(style_name)?;

    if !config.has_style(&style_name_obj) {
        anyhow::bail!("ã‚¨ãƒ©ãƒ¼: ã‚¹ã‚¿ã‚¤ãƒ« '{}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“", style_name);
    }

    // CLAUDE.md ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆèª­ã¿è¾¼ã¿
    let claude_md_path = "CLAUDE.md";
    if !Path::new(claude_md_path).exists() {
        anyhow::bail!("ã‚¨ãƒ©ãƒ¼: CLAUDE.md ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã« 'aad init' ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„");
    }

    let template = fs::read_to_string(claude_md_path)?;

    // ãƒˆãƒ¼ã‚¯ãƒ³ç½®æ›
    let token_map = config
        .get_token_map(&style_name_obj)
        .ok_or_else(|| anyhow::anyhow!("ãƒˆãƒ¼ã‚¯ãƒ³ãƒãƒƒãƒ—ãŒå–å¾—ã§ãã¾ã›ã‚“"))?;

    let result = token_map.apply(&template)?;

    // çµæœã‚’ä¿å­˜
    fs::write(claude_md_path, result)?;

    println!("âœ“ ã‚¹ã‚¿ã‚¤ãƒ« '{}' ã‚’ CLAUDE.md ã«é©ç”¨ã—ã¾ã—ãŸ", style_name);

    Ok(())
}
```

### 2. commands/mod.rs æ›´æ–°
```rust
pub mod style;

pub use style::{list as style_list, apply as style_apply};
```

### 3. main.rs ã«çµ±åˆ
```rust
use commands::StyleAction;

match cli.command {
    // ...
    Commands::Style { action } => match action {
        StyleAction::List => commands::style_list()?,
        StyleAction::Apply { style_name } => commands::style_apply(&style_name)?,
    },
    // ...
}
```

---

## å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | æ“ä½œ | èª¬æ˜ |
|----------|------|------|
| `crates/cli/src/commands/style.rs` | æ–°è¦ | style ã‚³ãƒãƒ³ãƒ‰å®Ÿè£… |
| `crates/cli/src/commands/mod.rs` | å¤‰æ›´ | style ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ  |
| `crates/cli/src/main.rs` | å¤‰æ›´ | style ã‚³ãƒãƒ³ãƒ‰å‘¼ã³å‡ºã— |

---

## å—ã‘å…¥ã‚ŒåŸºæº–

- [ ] AC-7.1: `aad style list` ã§ã‚¹ã‚¿ã‚¤ãƒ«ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] AC-7.2: `aad style apply <style-name>` ã§ã‚¹ã‚¿ã‚¤ãƒ«ãŒ `CLAUDE.md` ã«é©ç”¨ã•ã‚Œã‚‹
- [ ] AC-7.3: ãƒˆãƒ¼ã‚¯ãƒ³ç½®æ›ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ï¼ˆä¾‹: `{{role}}` â†’ `è³¢è€…`ï¼‰
- [ ] AC-7.4: æœªå®šç¾©ã®ã‚¹ã‚¿ã‚¤ãƒ«æŒ‡å®šæ™‚ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

## ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰

```bash
# ã‚¹ã‚¿ã‚¤ãƒ«ä¸€è¦§è¡¨ç¤º
cargo run -p cli -- style list

# ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨ï¼ˆäº‹å‰ã«CLAUDE.mdã«{{role}}ãªã©ã‚’è¿½åŠ ï¼‰
cargo run -p cli -- style apply sage

# CLAUDE.md ç¢ºèª
cat CLAUDE.md

# æœªå®šç¾©ã‚¹ã‚¿ã‚¤ãƒ«ã§ã‚¨ãƒ©ãƒ¼ç¢ºèª
cargo run -p cli -- style apply unknown
```

---

## æœŸå¾…çµæœ

### style list
```
ğŸ“‹ åˆ©ç”¨å¯èƒ½ãªã‚¹ã‚¿ã‚¤ãƒ«:

  â€¢ standard
  â€¢ sage
```

### style apply
```
âœ“ ã‚¹ã‚¿ã‚¤ãƒ« 'sage' ã‚’ CLAUDE.md ã«é©ç”¨ã—ã¾ã—ãŸ
```

---

## å‚™è€ƒ

- StyleConfig ã¨ TokenMap ã¯ SPEC-002 ã§å®Ÿè£…æ¸ˆã¿
- ãƒˆãƒ¼ã‚¯ãƒ³ç½®æ›ãƒ­ã‚¸ãƒƒã‚¯ã¯ Domain å±¤ã® TokenMap ã‚’ä½¿ç”¨
