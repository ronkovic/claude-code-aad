# SPEC-001-T05: Entities - Spec & Task定義

## 基本情報

| 項目 | 内容 |
|------|------|
| **タスクID** | SPEC-001-T05 |
| **タイトル** | Entities - Spec & Task定義 |
| **複雑度** | M（4-8時間） |
| **依存タスク** | SPEC-001-T02, SPEC-001-T03 |
| **優先度** | Must Have |
| **ステータス** | 未着手 |

## 概要

`Spec`エンティティと`Task`エンティティを実装します。

## 作業内容

### 1. Specエンティティ実装
- フィールド定義:
  - `id: SpecId`
  - `name: String`
  - `description: String`
  - `phase: Phase`
  - `tasks: Vec<TaskId>`
  - `created_at: DateTime<Utc>`
  - `updated_at: DateTime<Utc>`
- メソッド実装:
  - `new()`: 新規作成
  - `add_task()`: タスク追加
  - `remove_task()`: タスク削除
  - `change_phase()`: フェーズ変更
- Debug, Clone実装

### 2. Taskエンティティ実装
- フィールド定義:
  - `id: TaskId`
  - `spec_id: SpecId`
  - `title: String`
  - `description: String`
  - `status: Status`
  - `priority: Priority`
  - `complexity: String`（S/M/L/XL）
  - `dependencies: Vec<TaskId>`
  - `created_at: DateTime<Utc>`
  - `updated_at: DateTime<Utc>`
- メソッド実装:
  - `new()`: 新規作成
  - `change_status()`: ステータス変更
  - `add_dependency()`: 依存関係追加
- Debug, Clone実装

### 3. バリデーション
- Spec: name空文字チェック
- Task: title空文字チェック、循環依存チェック

## 変更ファイル

- `crates/domain/src/entities/mod.rs`（更新）
- `crates/domain/src/entities/spec.rs`（新規）
- `crates/domain/src/entities/task.rs`（新規）

## 受け入れ基準

- [ ] Specエンティティが正しく定義されている
- [ ] Taskエンティティが正しく定義されている
- [ ] すべてのメソッドが正しく動作する
- [ ] バリデーションが機能する
- [ ] 単体テストがすべてパス
- [ ] テストカバレッジ80%以上
- [ ] rustdocコメントが記述されている

## テスト項目

```rust
#[cfg(test)]
mod tests {
    // Spec tests
    #[test]
    fn test_spec_creation() { /* ... */ }

    #[test]
    fn test_spec_add_task() { /* ... */ }

    #[test]
    fn test_spec_remove_task() { /* ... */ }

    #[test]
    fn test_spec_change_phase() { /* ... */ }

    // Task tests
    #[test]
    fn test_task_creation() { /* ... */ }

    #[test]
    fn test_task_change_status() { /* ... */ }

    #[test]
    fn test_task_add_dependency() { /* ... */ }

    #[test]
    fn test_task_circular_dependency_detection() { /* ... */ }
}
```

## テストコマンド

```bash
# テスト実行
cargo test --package domain spec task

# カバレッジ確認
cargo llvm-cov --package domain --html
```

## 備考

- chrono crateを使用してDateTime<Utc>を管理
- Serdeサポート（Serialize/Deserialize）を追加
- 後続タスクでRepository経由の永続化を実装
